const catalogURL="json/products.json",productsPage=document.getElementById("products_page");Array.prototype.clean=function(t){for(var n=0;n<this.length;n++)this[n]==t&&(this.splice(n,1),n--);return this};class Products{render(){fetch(catalogURL).then((t=>t.json())).then((t=>{let n="";t.forEach((t=>{n+=this.createPruductCard(t)})),productsPage.innerHTML=n,this.addSteppers(),this.choosePrice(),this.recountPrice()}))}createPruductCard(t){const n=t=>{let n="",s="";switch(t.unitFull){case"упаковка":n="упаковку",s=t.unitAlt;break;case"штука":n="штуку",s=t.unitAlt;break;case"метр погонный":n="метр погонный",s=t.unitAlt;break;case"комплект":n="комплект",s=t.unitFullAlt}return"штука"==s&&(s="штуку"),t.unitFull===t.unitFullAlt||""===t.unitFullAlt?{unit:`<div class="product_units">\n\t\t\t\t\t\t\t<div class="unit--wrapper">\n\t\t\t\t\t\t\t\t<div class="unit--select unit--active">\n\t\t\t\t\t\t\t\t\t<p class="ng-binding">За ${n}</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n      `,unitInfo:e(t)}:{unit:`\n      <div class="product_units">\n\t\t\t\t\t\t\t<div class="unit--wrapper">\n\t\t\t\t\t\t\t\t<div class="unit--select unit--active">\n\t\t\t\t\t\t\t\t\t<p class="ng-binding">За ${n}</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="unit--select">\n\t\t\t\t\t\t\t\t\t<p class="ng-binding">За ${s}</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n      `,unitInfo:null}},e=t=>{let n="";switch(t.unit){case"м/п":n="Продается метрами погонными:";break;case"упак.":n="Продается упаковками:";break;case"шт.":n="Продается штучно:";break;case"компл":n="Продается комплектом:"}return`<div class="list--unit-desc">\n        <div class="unit--info">\n\t\t\t\t\t\t\t\t<div class="unit--desc-i"></div>\n\t\t\t\t\t\t\t\t<div class="unit--desc-t">\n\t\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t\t<span class="ng-binding">${n}</span>\n\t\t\t\t\t\t\t\t\t\t<span class="unit--infoInn">${t.unitRatio} ${t.unit} = ${t.unitRatioAlt.toFixed(2)} ${t.unitAlt} </span>\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div></div>\n      `};return(t=>`\n        <div class="product product_horizontal">\n\t\t\t\t\t\t<span class="product_code">Код: ${+t.code}</span>\n\t\t\t\t\t\t<div class="product_status_tooltip_container">\n\t\t\t\t\t\t\t<span class="product_status">Наличие</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="product_photo">\n\t\t\t\t\t\t\t<a href="#" class="url--link product__link">\n\t\t\t\t\t\t\t\t<img src="${t.primaryImageUrl.replace(".jpg","_220x220_1.jpg")}" />\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="product_description">\n\t\t\t\t\t\t\t<a href="#" class="product__link"\n\t\t\t\t\t\t\t\t>${t.title}</a\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="product_tags hidden-sm">\n\t\t\t\t\t\t\t<p>Могут понадобиться:</p>\n\t\t\t\t\t\t\t${(t=>{let n=t.split(/;\n|;/).clean(""),e="";return n.forEach((t=>{e+=`<a href="#" class="url--link">${t},</a>`})),e})(t.assocProducts)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${n(t).unit}\n\t\t\t\t\t\t${(t=>`\n      <p class="product_price_club_card">\n\t\t\t\t\t\t\t<span class="product_price_club_card_text">По карте<br />клуба</span>\n\t\t\t\t\t\t\t<span class="goldPrice" altPrice="${+t.priceGold.toFixed(2)}">${+t.priceGoldAlt.toFixed(2)}</span>\n\t\t\t\t\t\t\t<span class="rouble__i black__i">\n\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\tversion="1.0"\n\t\t\t\t\t\t\t\t\tid="rouble__b"\n\t\t\t\t\t\t\t\t\txmlns="http://www.w3.org/2000/svg"\n\t\t\t\t\t\t\t\t\tx="0"\n\t\t\t\t\t\t\t\t\ty="0"\n\t\t\t\t\t\t\t\t\twidth="30px"\n\t\t\t\t\t\t\t\t\theight="22px"\n\t\t\t\t\t\t\t\t\tviewBox="0 0 50 50"\n\t\t\t\t\t\t\t\t\tenable-background="new 0 0 50 50"\n\t\t\t\t\t\t\t\t\txml:space="preserve"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<use\n\t\t\t\t\t\t\t\t\t\txmlns:xlink="http://www.w3.org/1999/xlink"\n\t\t\t\t\t\t\t\t\t\txlink:href="#rouble_black"\n\t\t\t\t\t\t\t\t\t></use>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<p class="product_price_default">\n\t\t\t\t\t\t\t<span class="retailPrice" altPrice="${+t.priceRetail.toFixed(2)}">${+t.priceRetailAlt.toFixed(2)}</span>\n\t\t\t\t\t\t\t<span class="rouble__i black__i">\n\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\tversion="1.0"\n\t\t\t\t\t\t\t\t\tid="rouble__g"\n\t\t\t\t\t\t\t\t\txmlns="http://www.w3.org/2000/svg"\n\t\t\t\t\t\t\t\t\tx="0"\n\t\t\t\t\t\t\t\t\ty="0"\n\t\t\t\t\t\t\t\t\twidth="30px"\n\t\t\t\t\t\t\t\t\theight="22px"\n\t\t\t\t\t\t\t\t\tviewBox="0 0 50 50"\n\t\t\t\t\t\t\t\t\tenable-background="new 0 0 50 50"\n\t\t\t\t\t\t\t\t\txml:space="preserve"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<use\n\t\t\t\t\t\t\t\t\t\txmlns:xlink="http://www.w3.org/1999/xlink"\n\t\t\t\t\t\t\t\t\t\txlink:href="#rouble_gray"\n\t\t\t\t\t\t\t\t\t></use>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<div class="product_price_points">\n\t\t\t\t\t\t\t<p class="ng-binding">Можно купить за ${t.bonusAmount} балла</p>\n\t\t\t\t\t\t</div>\n      `)(t)}\n            <div class="list--unit-padd"></div>\n            \n\t\t\t\t\t\t${n(t).unitInfo?n(t).unitInfo:""}\n\t\t\t\t\t\t<div class="product__wrapper">\n\t\t\t\t\t\t\t<div class="product_count_wrapper">\n\t\t\t\t\t\t\t\t<div class="stepper">\n\t\t\t\t\t\t\t\t\t<input class="product__count stepper-input" type="text" value="1" />\n\t\t\t\t\t\t\t\t\t<span class="stepper-arrow up"></span>\n\t\t\t\t\t\t\t\t\t<span class="stepper-arrow down"></span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclass="btn btn_cart"\n\t\t\t\t\t\t\t\tdata-url="/cart/"\n\t\t\t\t\t\t\t\tdata-product-id="${t.productId}"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<svg class="ic ic_cart">\n\t\t\t\t\t\t\t\t\t<use\n\t\t\t\t\t\t\t\t\t\txmlns:xlink="http://www.w3.org/1999/xlink"\n\t\t\t\t\t\t\t\t\t\txlink:href="#cart"\n\t\t\t\t\t\t\t\t\t></use>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t<span class="ng-binding">В корзину</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n      `)(t)}addSteppers(){const t=document.querySelectorAll(".up"),n=document.querySelectorAll(".down");let e="";t.forEach((t=>{t.addEventListener("click",(()=>{e=t.closest(".stepper").querySelector("input"),e.value++,e.dispatchEvent(new Event("change"))}))})),n.forEach((t=>{t.addEventListener("click",(()=>{e=t.closest(".stepper").querySelector("input"),e.value--,e.dispatchEvent(new Event("change")),e.value<1&&(e.value=1)}))}))}choosePrice(){document.querySelectorAll(".unit--select").forEach((t=>{t.addEventListener("click",(()=>{let n="",e="",s="",i="",c="";const r=t=>{e=t.getAttribute("altPrice"),s=t.innerHTML,t.setAttribute("altPrice",s),t.innerHTML=e};t.classList.contains("unit--active")||(n=t.parentElement,n.querySelector(".unit--active").classList.remove("unit--active"),t.classList.add("unit--active"),i=n.closest(".product").querySelector(".goldPrice"),r(i),c=n.closest(".product").querySelector(".retailPrice"),r(c))}))}))}recountPrice(){document.querySelectorAll(".stepper-input").forEach((t=>{let n="",e="";t.addEventListener("change",(()=>{n=t.closest(".product").querySelector(".goldPrice"),e=t.closest(".product").querySelector(".retailPrice")}))}))}}const productPage=new Products;productPage.render();
//# sourceMappingURL=main.min.js.map
